name: Deploy to Production

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python 3.11
      uses: actions/setup-python@v3
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '20'
    
    - name: Install pnpm
      run: npm install -g pnpm
    
    - name: Build frontend
      run: |
        cd frontend
        pnpm install
        pnpm run build
        cp -r dist/* ../src/static/
    
    - name: Run tests (if any)
      run: |
        # Add your test commands here
        echo "No tests configured yet"
    
    - name: Deploy to production
      run: |
        echo "Deployment would happen here"
        echo "This is a template - actual deployment depends on your hosting provider"
        
    # Example for deploying to Heroku
    # - name: Deploy to Heroku
    #   uses: akhileshns/heroku-deploy@v3.12.12
    #   with:
    #     heroku_api_key: ${{secrets.HEROKU_API_KEY}}
    #     heroku_app_name: "your-app-name"
    #     heroku_email: "your-email@example.com"
    
    # Example for deploying to Railway
    # - name: Deploy to Railway
    #   run: |
    #     npm install -g @railway/cli
    #     railway login --token ${{ secrets.RAILWAY_TOKEN }}
    #     railway up

